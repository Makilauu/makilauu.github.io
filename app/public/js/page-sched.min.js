// @import components/eventsManager
// @import components/Request
// @import components/result
// @import components/sched
// @import components/Spinner
// @import components/scroll
// @import components/Swipe
// @import components/standalone
// @import components/links
// @import components/RegParser
var pageSched={spinner:new Spinner,swipe:new Swipe,days:document.getElementsByClassName("days")[0],breakpoint:1060,mobile:!1,defaultDaySet:!1,message:{element:document.createElement("span"),all:["Remerciez Satellys pour la latence...","Non, les cours ne sont pas annulés...","Ne partez pas ça devrait arriver...","Profitez-en pour vous servir un café...","C'est l'histoire de Jano Lapin...","L'temps passe, j'vois l'soleil s'lever, s'coucher...","Currently trying to make the world a better place...","Attention derrière toi...","L'accès Satellys j'l'ai pas loué..."],get random(){return this.all[Math.floor(Math.random()*this.all.length)]},set:function(){this.element.innerHTML="",this.element.appendChild(document.createTextNode(this.random))},init:function(){pageSched.spinner.element.appendChild(this.element)}},set loading(e){document.body.className=e?"loading":"",this.message.set(),e?this.spinner.show():this.spinner.hide()},get filters(){var e=this.form.groupFilters[this.form.group];if(void 0!==e&&null!==e)for(var t=this.form.filters,i=[],n=0;n<t.length;n++){var s=t[n];if(""!=s.value){var a=this.form.filtersData[e][s.name];i.push({test:a.test,match:RegParser.compile(a.match),value:RegParser.compile(a.list[s.value])})}}return i},update:function(e){this.form.update(),this.get(this.form.year,this.form.week,this.form.group,e)},clear:function(){this.days.innerHTML=""},form:{filtersData:api.filters,currentGroupFilters:null,groupFilters:api.groupFilters,element:document.getElementsByTagName("form")[0],filtersField:document.getElementsByTagName("form")[0].getElementsByClassName("filters")[0],inputs:{filters:document.getElementsByTagName("form")[0].getElementsByClassName("filters")[0].getElementsByTagName("select")},get group(){return this.inputs.group.value},get year(){return this.inputs.year.value},get week(){return this.inputs.week.value},get filters(){return Array.prototype.slice.call(this.inputs.filters).map(function(e){return{name:e.name,value:e.value}})},update:function(){var e=this.groupFilters[this.group];if(e!=this.currentGroupFilters)if(this.currentGroupFilters=e,this.filtersField.innerHTML="",null!==e&&void 0!==e){var t=this.filtersData[e];if(void 0!==t){this.filtersField.removeAttribute("data-empty");for(var i in t){var n=t[i],s=document.createElement("div"),a=document.createElement("label"),r=document.createElement("select"),l="filter-"+i;s.className="filter",a.appendChild(document.createTextNode(i)),a.setAttribute("for",l),r.name=i,r.id=l,r.on("change",this.onchange);var o=document.createElement("option");o.value="",o.appendChild(document.createTextNode("Aucun")),r.appendChild(o);for(var u in n.list){var o=document.createElement("option");o.value=u,o.appendChild(document.createTextNode(u)),r.appendChild(o)}s.appendChild(a),s.appendChild(r),this.filtersField.appendChild(s)}}}else{this.filtersField.setAttribute("data-empty",!0);var c=document.createElement("p");c.appendChild(document.createTextNode("Aucun filtre disponible")),this.filtersField.appendChild(c)}},onchange:function(){pageSched.update()},init:function(){for(var e=this.element.getElementsByTagName("select"),t=0;t<e.length;t++){var i=e[t];"filter"!=i.parentNode.className&&(this.inputs[i.id.substr(6)]=i),i.on("change",this.onchange)}}},get:function(e,t,i,n){var s=this;this.loading=!0,"function"!=typeof n&&(n=function(){}),sched.get(e,t,i,this.filters,function(e,t){e?(s.clear(),sched.constructor.insert(t.days),n()):result.set(t.message),s.loading=!1})},onresize:function(e){window.innerWidth>this.breakpoint&&(this.mobile||e===!0)?(this.swipe.page=0,this.swipe.disabled=!0,this.mobile=!1):window.innerWidth<this.breakpoint&&!this.mobile&&(this.defaultDaySet||(this.swipe.page=api.defaultDay-1,this.defaultDaySet=!0),this.mobile=!0,this.swipe.disabled=!1)},init:function(){var e=this;on("resize",function(){e.onresize()}),this.swipe.element=this.days,this.swipe.init(),this.message.init(),this.form.init(),this.update(function(){e.onresize(!0)})}};pageSched.init();