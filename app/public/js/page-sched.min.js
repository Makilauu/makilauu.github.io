// @import components/eventsManager
// @import components/Request
// @import components/result
// @import components/sched
// @import components/Spinner
// @import components/scroll
var pageSched={spinner:new Spinner,days:document.getElementsByClassName("days")[0],message:{element:document.createElement("span"),all:["Remerciez Satellys pour la latence...","Non, les cours ne sont pas annulés...","Ne partez pas ça devrait arriver..."],get random(){return this.all[Math.floor(Math.random()*(this.all.length-1))]},set:function(){this.element.innerHTML="",this.element.appendChild(document.createTextNode(this.random))},init:function(){pageSched.spinner.element.appendChild(this.element)}},set loading(e){this.days.className=e?"days hidden":"days",this.message.set(),e?this.spinner.show():this.spinner.hide()},update:function(){this.form.update(),this.get(this.form.year,this.form.week,this.form.group,this.form.filter)},clear:function(){this.days.innerHTML=""},form:{element:document.getElementsByTagName("form")[0],filters:document.getElementsByTagName("form")[0].getElementsByClassName("filters")[0],inputs:{get filter(){return pageSched.form.filters.getElementsByClassName("visible")[0].getElementsByTagName("select")[0]}},get group(){return this.inputs.group.value},get year(){return this.inputs.year.value},get week(){return this.inputs.week.value},get filter(){return this.inputs.filter.value},update:function(){for(var e=this.filters.getElementsByClassName("visible"),t=0;t<e.length;t++)e[t].className="";var n=document.getElementById("sched-filter-"+api.filters[this.group]);n||(n=document.getElementById("sched-filter-none")),n.parentNode.className="visible"},onchange:function(){pageSched.update()},init:function(){for(var e=this.element.getElementsByTagName("select"),t=0;t<e.length;t++){var n=e[t];"sched-filter-"!=n.id.substring(0,13)&&(this.inputs[n.id.substr(6)]=n),n.on("change",this.onchange)}}},get:function(e,t,n,s){var i=this;this.loading=!0,sched.get(e,t,n,s,function(e,t){e?(i.clear(),sched.constructor.insert(t.days)):result.set(t.message),i.loading=!1})},onscroll:function(){scroll.top<=0&&"scroll-top"!=document.body.className?document.body.className="scroll-top":scroll.top>0&&"scroll-top"==document.body.className&&(document.body.className="")},init:function(){var e=this;on("scroll",e.onscroll),this.message.init(),this.form.init(),this.update()}};pageSched.init();